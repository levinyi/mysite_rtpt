# Tandem Repeats Mismatch å‚æ•°ä½¿ç”¨æŒ‡å—

## ğŸ“– æ¦‚è¿°

Tandem Repeats çš„ **Max Mismatch** å‚æ•°å…è®¸æ£€æµ‹ä¸å®Œç¾çš„ä¸²è”é‡å¤åºåˆ—ã€‚è¿™å¯¹äºè¯†åˆ«çœŸå®ä¸–ç•Œä¸­å¸¦æœ‰çªå˜æˆ–æµ‹åºé”™è¯¯çš„é‡å¤åºåˆ—éå¸¸é‡è¦ã€‚

---

## ğŸ¯ ä¸‰ç§æ¨¡å¼

### æ¨¡å¼ 0ï¼šStrictï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰
- **è¯´æ˜**ï¼šåªæ£€æµ‹å®Œç¾çš„ä¸²è”é‡å¤ï¼Œä¸å…è®¸ä»»ä½•é”™é…
- **é€‚ç”¨åœºæ™¯**ï¼š
  - æœ€ä¸¥æ ¼çš„è´¨é‡æ§åˆ¶
  - ç ”ç©¶å®Œç¾é‡å¤åºåˆ—
  - å­¦æœ¯ç ”ç©¶éœ€è¦ç²¾ç¡®åŒ¹é…

### æ¨¡å¼ 1ï¼šStandardï¼ˆæ ‡å‡†æ¨¡å¼ï¼‰â­ **æ¨è**
- **è¯´æ˜**ï¼šå…è®¸æ¯ä¸ªé‡å¤å•å…ƒæœ‰ 1 ä¸ªç¢±åŸºé”™é…
- **é€‚ç”¨åœºæ™¯**ï¼š
  - âœ… **åŸºå› åˆæˆ**ï¼ˆæ¨èç”¨äºç”Ÿäº§ï¼‰
  - æ£€æµ‹å¸¦æœ‰è‡ªç„¶çªå˜çš„é‡å¤
  - å¹³è¡¡çµæ•åº¦å’Œç‰¹å¼‚æ€§
  - ç¬¦åˆä¸šç•Œæ ‡å‡†

### æ¨¡å¼ 2ï¼šRelaxedï¼ˆå®½æ¾æ¨¡å¼ï¼‰
- **è¯´æ˜**ï¼šå…è®¸æ¯ä¸ªé‡å¤å•å…ƒæœ‰ 2 ä¸ªç¢±åŸºé”™é…
- **é€‚ç”¨åœºæ™¯**ï¼š
  - é«˜å˜å¼‚åŒºåŸŸåˆ†æ
  - è¿›åŒ–ç ”ç©¶
  - å¯èƒ½è¿‡åº¦æ£€æµ‹ï¼Œæ…ç”¨

---

## ğŸ§¬ å®é™…ç¤ºä¾‹

### æµ‹è¯•åºåˆ—

è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªåŒ…å«ä¸å®Œç¾é‡å¤çš„åºåˆ—æ¥æ¼”ç¤ºï¼š

```
åºåˆ—åç§°: Test_Imperfect_Tandem
åºåˆ—å†…å®¹: ATCATCATGATCATCGGGAAA
          ^^^^^^^^^^^
          è¿™æ˜¯ä¸€ä¸ªä¸å®Œç¾çš„ä¸²è”é‡å¤
          é‡å¤å•å…ƒ: ATC
          ç¬¬3ä¸ªé‡å¤æœ‰1ä¸ªé”™é…: ATC â†’ ATG
          ç¬¬5ä¸ªé‡å¤æœ‰1ä¸ªé”™é…: ATC â†’ ATG
```

---

## ğŸ“Š ä¸åŒæ¨¡å¼çš„æ£€æµ‹ç»“æœ

| æ¨¡å¼ | Max Mismatch | æ£€æµ‹ç»“æœ | è¯´æ˜ |
|------|--------------|----------|------|
| Strict | 0 | `ATCATC` (6 bp) | åªæ£€æµ‹åˆ°å‰2ä¸ªå®Œç¾é‡å¤ |
| **Standard** | **1** | `ATCATCATGATCATC` (15 bp) | âœ… æ£€æµ‹åˆ°5ä¸ªé‡å¤ï¼ˆæ¨èï¼‰ |
| Relaxed | 2 | `ATCATCATGATCATC` (15 bp) | åŒä¸Šï¼ˆæ­¤ä¾‹æœªè¶…è¿‡2ä¸ªé”™é…ï¼‰ |

---

## ğŸ”¬ ç”Ÿç‰©å­¦æ„ä¹‰

### ä¸ºä»€ä¹ˆè¦å…è®¸ Mismatchï¼Ÿ

1. **DNA å¤åˆ¶é”™è¯¯**ï¼š
   - è‡ªç„¶ç•Œçš„ DNA å¤åˆ¶ä¸æ˜¯100%å‡†ç¡®
   - èšåˆé…¶å¯èƒ½æ’å…¥é”™è¯¯ç¢±åŸº

2. **æµ‹åºé”™è¯¯**ï¼š
   - æµ‹åºæŠ€æœ¯æœ‰ 0.1-1% é”™è¯¯ç‡
   - é‡å¤åŒºåŸŸæ›´å®¹æ˜“å‡ºé”™

3. **è‡ªç„¶è¿›åŒ–**ï¼š
   - å¾®å«æ˜Ÿåºåˆ—ï¼ˆSTRï¼‰ç»å¸¸æœ‰çªå˜
   - ä¸å®Œç¾é‡å¤ä»ç„¶åŠŸèƒ½æ€§ç›¸å…³

4. **åŸºå› åˆæˆå½±å“**ï¼š
   - âŒ å³ä½¿æœ‰1ä¸ªé”™é…ï¼Œä¸²è”é‡å¤ä»ä¼šï¼š
     - å¯¼è‡´ PCR æ»‘ç§»
     - æµ‹åºå›°éš¾
     - å…‹éš†ä¸ç¨³å®š
     - åˆæˆå¤±è´¥ç‡é«˜

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æ–¹æ³• 1ï¼šåœ¨ç½‘é¡µç•Œé¢æµ‹è¯•

1. è®¿é—®ï¼š`http://192.168.3.185:8000/tools/SequenceAnalyzer/`

2. åœ¨è¡¨æ ¼ä¸­è¾“å…¥æµ‹è¯•åºåˆ—ï¼š
   ```
   GeneName                    SeqNT
   Test_Perfect                ATCATCATCATCGGG
   Test_1Mismatch              ATCATCATGATCATCGGG
   Test_2Mismatch              ATCATGATGATCATCGGG
   ```

3. å±•å¼€ **"Advanced Parameters (Optional)"**

4. åœ¨ **"Tandem: Max Mismatch"** ä¸­é€‰æ‹©ä¸åŒæ¨¡å¼ï¼š
   - ğŸ›¡ï¸ **0 - Strict**
   - â­ **1 - Standard** (é»˜è®¤ï¼Œå·²é€‰ä¸­)
   - ğŸ” **2 - Relaxed**

5. ç‚¹å‡» **"Submit & Analyze Sequences"**

6. è§‚å¯Ÿç»“æœå·®å¼‚

---

### æ–¹æ³• 2ï¼šä½¿ç”¨ API æµ‹è¯•

```python
import requests
import json

API_URL = "http://192.168.3.185:8000/tools/api/sequence-analysis/"

# æµ‹è¯•åºåˆ—
test_sequences = [
    {
        "gene_id": "Test_Perfect",
        "sequence": "ATCATCATCATCGGG"
    },
    {
        "gene_id": "Test_1Mismatch",
        "sequence": "ATCATCATGATCATCGGG"
    }
]

# æµ‹è¯•ä¸åŒçš„ mismatch è®¾ç½®
for max_mismatch in [0, 1, 2]:
    print(f"\n{'='*60}")
    print(f"Testing with max_mismatch = {max_mismatch}")
    print(f"{'='*60}")

    data = {
        "sequences": test_sequences,
        "parameters": {
            "tandem_max_mismatch": max_mismatch
        }
    }

    response = requests.post(API_URL, json=data)
    result = response.json()

    for gene_id in ["Test_Perfect", "Test_1Mismatch"]:
        tandem_repeats = result['data'][gene_id]['features']['TandemRepeats']
        print(f"\n{gene_id}:")
        if tandem_repeats:
            for tr in tandem_repeats:
                print(f"  - ä½ç½® {tr['start']}-{tr['end']}, é•¿åº¦ {tr['length']} bp")
        else:
            print(f"  - æœªæ£€æµ‹åˆ°")
```

---

## ğŸ“‹ æ¨èè®¾ç½®

### åŸºå› åˆæˆï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
```
âœ… Tandem: Max Mismatch = 1 (Standard)
```
**ç†ç”±**ï¼š
- å¹³è¡¡çµæ•åº¦å’Œç‰¹å¼‚æ€§
- ä¸ä¼šæ¼æ‰æœ‰é—®é¢˜çš„åºåˆ—
- ä¸ä¼šè¿‡åº¦æ£€æµ‹
- ç¬¦åˆè¡Œä¸šæ ‡å‡†

### ç ”ç©¶/è´¨æ§ï¼ˆä¸¥æ ¼ç¯å¢ƒï¼‰
```
âœ… Tandem: Max Mismatch = 0 (Strict)
```
**ç†ç”±**ï¼š
- åªæŠ¥å‘Šå®Œç¾é‡å¤
- æœ€é«˜ç²¾ç¡®åº¦
- é€‚åˆå­¦æœ¯å‘è¡¨

### è¿›åŒ–/å˜å¼‚åˆ†æ
```
âœ… Tandem: Max Mismatch = 2 (Relaxed)
```
**ç†ç”±**ï¼š
- æ•è·æ›´å¤šå˜å¼‚
- é€‚åˆæ¯”è¾ƒåŸºå› ç»„å­¦
- å¾®å«æ˜Ÿå¤šæ€æ€§ç ”ç©¶

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### ç®—æ³•å®ç°

Mismatch æ£€æµ‹é€šè¿‡é€ç¢±åŸºæ¯”è¾ƒå®ç°ï¼š

```python
# ä¼ªä»£ç 
for each repeat_unit:
    mismatches = 0
    for each base in repeat_unit:
        if base != expected_base:
            mismatches += 1

    if mismatches <= max_mismatch:
        # ç»§ç»­æ‰©å±•é‡å¤
    else:
        # åœæ­¢æ‰©å±•
```

### å‚æ•°éªŒè¯

åç«¯è‡ªåŠ¨éªŒè¯ï¼Œç¡®ä¿å€¼åªèƒ½æ˜¯ 0, 1, 2ï¼š

```python
# tools/views.py
tandem_max_mismatch = int(request.POST.get('tandemMaxMismatch', 1))
if tandem_max_mismatch not in [0, 1, 2]:
    tandem_max_mismatch = 1  # è‡ªåŠ¨å›é€€åˆ°é»˜è®¤å€¼
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆé™åˆ¶åªèƒ½ 0ã€1ã€2ï¼Ÿ

**A**:
- è¶…è¿‡ 2 ä¸ªé”™é…çš„"é‡å¤"ç”Ÿç‰©å­¦æ„ä¹‰ä¸å¤§
- å¯èƒ½è¯¯æŠ¥éé‡å¤åºåˆ—
- å¢åŠ è®¡ç®—å¤æ‚åº¦

### Q2: é»˜è®¤ä¸ºä»€ä¹ˆæ˜¯ 1ï¼Ÿ

**A**:
- åŸºäºåŸºå› åˆæˆè¡Œä¸šç»éªŒ
- å¹³è¡¡çµæ•åº¦å’Œç‰¹å¼‚æ€§
- ç¬¦åˆå¤§å¤šæ•°å®é™…åº”ç”¨åœºæ™¯

### Q3: æˆ‘åº”è¯¥ç”¨å“ªä¸ªæ¨¡å¼ï¼Ÿ

**A**:
- ğŸ­ **ç”Ÿäº§/åˆæˆ** â†’ ä½¿ç”¨ **1 (Standard)**
- ğŸ”¬ **ç ”ç©¶/å‘è¡¨** â†’ ä½¿ç”¨ **0 (Strict)**
- ğŸ§¬ **è¿›åŒ–åˆ†æ** â†’ ä½¿ç”¨ **2 (Relaxed)**

### Q4: Mismatch ä¼šå½±å“ç½šåˆ†å—ï¼Ÿ

**A**:
- ç›®å‰ä¸å½±å“ç½šåˆ†è®¡ç®—
- ç½šåˆ†åªåŸºäºé‡å¤çš„æ€»é•¿åº¦
- æœªæ¥å¯èƒ½è€ƒè™‘é”™é…æ•°é‡ä½œä¸ºç½šåˆ†å› å­

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `docs/TEST_SEQUENCES.md` - æµ‹è¯•åºåˆ—è¯¦ç»†è¯´æ˜
- `docs/API_SEQUENCE_ANALYSIS.md` - API å®Œæ•´æ–‡æ¡£
- `docs/QUICK_TEST_GUIDE.md` - å¿«é€Ÿæµ‹è¯•æŒ‡å—

---

## ğŸ‰ æ€»ç»“

| ç‰¹æ€§ | å€¼ |
|------|---|
| å¯é€‰å€¼ | 0, 1, 2 |
| é»˜è®¤å€¼ | 1 (Standard) |
| æ¨èå€¼ | 1 (åŸºå› åˆæˆ) |
| ç•Œé¢ç±»å‹ | å•é€‰æŒ‰é’®ç»„ |
| åç«¯éªŒè¯ | âœ… è‡ªåŠ¨éªŒè¯ |
| API æ”¯æŒ | âœ… å®Œå…¨æ”¯æŒ |

**æ›´æ–°æ—¥æœŸ**: 2025-11-06
**ç‰ˆæœ¬**: v2.1 (Tandem Mismatch Parameter)
