# Palindrome Repeats ç®—æ³•ä¿®å¤

## ğŸ“… ä¿®å¤æ—¥æœŸ
2025-11-06

---

## ğŸ› é—®é¢˜æè¿°

### ç”¨æˆ·æŠ¥å‘Šçš„é—®é¢˜

ç”¨æˆ·åºåˆ—ï¼š
```
ATCGATCGATCGATCGGGGGGGGGGGGGCGATCGATCGATCG
```

**æ£€æµ‹åˆ°çš„ç»“æœ**ï¼ˆä¿®å¤å‰ï¼‰ï¼š
```
Palindrome Repeats:
  sequence: CGGGGGGGGGGGGGC
  start: 14
  end: 28
  length: 15
  Score: 0.0
```

**é—®é¢˜åˆ†æ**ï¼š

åºåˆ— `CGGGGGGGGGGGGGC` æ˜¯ä¸€ä¸ª**å­—ç¬¦ä¸²å›æ–‡**ï¼ˆä»ä¸­å¿ƒå¯¹ç§°ï¼‰ï¼Œä½†**ä¸æ˜¯DNAå›æ–‡**ï¼š

| ç±»å‹ | åŸåºåˆ— | åå‘äº’è¡¥ | ç›¸ç­‰ï¼Ÿ |
|------|--------|----------|--------|
| å­—ç¬¦ä¸²å›æ–‡ | CGGGGGGGGGGGGGC | - | C=C, G=Gï¼ˆå¯¹ç§°ï¼‰âœ“ |
| **DNAå›æ–‡** | CGGGGGGGGGGGGGC | GCCCCCCCCCCCCCG | âŒ **ä¸ç›¸ç­‰** |

è¿™ä¸ªåºåˆ—å®é™…ä¸Šæ˜¯ä¸€ä¸ª **Homopolymer (å•ç¢±åŸºé‡å¤)**ï¼Œä¸åº”è¯¥è¢«æ£€æµ‹ä¸ºå›æ–‡åºåˆ—ã€‚

---

## ğŸ”¬ æ ¹æœ¬åŸå› 

### åŸç®—æ³•é—®é¢˜

åŸç®—æ³•ä½¿ç”¨äº†**å­—ç¬¦ä¸²å›æ–‡**çš„æ£€æµ‹æ–¹æ³•ï¼š

```python
# ä»ä¸­å¿ƒå‘ä¸¤è¾¹æ‰©å±•
start, end = center, center
while start >= 0 and end < n and s[start] == s[end]:
    # æ£€æŸ¥ s[start] == s[end]
    # è¿™æ˜¯å­—ç¬¦ä¸²å›æ–‡ï¼Œä¸æ˜¯DNAå›æ–‡ï¼
```

è¿™ç§æ–¹æ³•æ£€æµ‹çš„æ˜¯å­—ç¬¦ä¸²å¯¹ç§°æ€§ï¼ˆå¦‚ "ABCBA"ï¼‰ï¼Œè€Œä¸æ˜¯ç”Ÿç‰©å­¦æ„ä¹‰ä¸Šçš„DNAå›æ–‡ã€‚

### DNAå›æ–‡çš„æ­£ç¡®å®šä¹‰

DNAå›æ–‡å¿…é¡»æ»¡è¶³ï¼š**åºåˆ— == reverse_complement(åºåˆ—)**

```python
def reverse_complement(seq):
    complement = {'A': 'T', 'T': 'A', 'C': 'G', 'G': 'C'}
    return ''.join(complement[base] for base in reversed(seq))

def is_dna_palindrome(seq):
    return seq == reverse_complement(seq)
```

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### æ–°ç®—æ³•å®ç°

å®Œå…¨é‡å†™ `find_palindrome_repeats()` å‡½æ•°ï¼š

```python
def find_palindrome_repeats(self, index=None, min_len=15):
    """
    æŸ¥æ‰¾DNAå›æ–‡åºåˆ—ï¼ˆPalindromic Sequencesï¼‰

    DNAå›æ–‡å®šä¹‰ï¼šåºåˆ—ç­‰äºå…¶åå‘äº’è¡¥åºåˆ—
    ä¾‹å¦‚ï¼š
    - ATCGAT â†’ åå‘äº’è¡¥ ATCGAT (ç›¸åŒï¼Œæ˜¯DNAå›æ–‡)
    - GAATTC â†’ åå‘äº’è¡¥ GAATTC (EcoRIé™åˆ¶æ€§ä½ç‚¹)
    - CGGGGGC â†’ åå‘äº’è¡¥ GCCCCCG (ä¸åŒï¼Œä¸æ˜¯DNAå›æ–‡)
    """

    # å®šä¹‰åå‘äº’è¡¥å‡½æ•°
    def reverse_complement(seq):
        complement = {'A': 'T', 'T': 'A', 'C': 'G', 'G': 'C'}
        return ''.join(complement[base] for base in reversed(seq.upper()))

    def is_dna_palindrome(seq):
        return seq == reverse_complement(seq)

    # éå†æ‰€æœ‰å¯èƒ½çš„å­åºåˆ—
    for start in range(n - min_len + 1):
        # DNAå›æ–‡å¿…é¡»æ˜¯å¶æ•°é•¿åº¦
        for length in range(min_len, min(n - start + 1, 200), 2):
            end = start + length - 1
            seq = s[start:end + 1]

            # æ£€æŸ¥æ˜¯å¦æ˜¯DNAå›æ–‡
            if is_dna_palindrome(seq):
                if not is_excluded(seq):
                    palindromes.append({...})

    # è¿‡æ»¤é‡å çš„å›æ–‡
    return self._filter_overlapping_palindromes(palindromes)
```

### å…³é”®æ”¹è¿›

1. **æ­£ç¡®çš„DNAå›æ–‡æ£€æµ‹**ï¼šä½¿ç”¨ `sequence == reverse_complement(sequence)`
2. **åªæ£€æŸ¥å¶æ•°é•¿åº¦**ï¼šDNAå›æ–‡å¿…ç„¶æ˜¯å¶æ•°é•¿åº¦
3. **é‡å è¿‡æ»¤**ï¼šé¿å…æŠ¥å‘Šå¤§é‡é‡å çš„å›æ–‡åºåˆ—
4. **æ•ˆç‡ä¼˜åŒ–**ï¼šé™åˆ¶æœ€å¤§é•¿åº¦ä¸º200bp

---

## ğŸ“Š ä¿®å¤å‰åå¯¹æ¯”

### æµ‹è¯•åºåˆ— 1ï¼šç”¨æˆ·é—®é¢˜åºåˆ—

**åºåˆ—**ï¼š`ATCGATCGATCGATCGGGGGGGGGGGGGCGATCGATCGATCG`

| åŒºåŸŸ | ä½ç½® | æ˜¯DNAå›æ–‡ï¼Ÿ | ä¿®å¤å‰ | ä¿®å¤å |
|------|------|-------------|--------|--------|
| `ATCGATCGATCGAT` | 0-13 | âœ… æ˜¯ | å¯èƒ½æœªæ£€æµ‹ | âœ… æ­£ç¡®æ£€æµ‹ |
| `CGGGGGGGGGGGGGC` | 14-28 | âŒ å¦ | âŒ **è¯¯æ£€æµ‹** | âœ… **ä¸æ£€æµ‹** |
| `CGATCGATCGATCG` | 28-41 | âœ… æ˜¯ | å¯èƒ½æœªæ£€æµ‹ | âœ… æ­£ç¡®æ£€æµ‹ |

### æµ‹è¯•åºåˆ— 2ï¼šå‡å›æ–‡

**åºåˆ—**ï¼š`AAACGGGGGGGGGGGCAAA`

| å­åºåˆ— | å­—ç¬¦ä¸²å›æ–‡ï¼Ÿ | DNAå›æ–‡ï¼Ÿ | ä¿®å¤å‰ | ä¿®å¤å |
|--------|-------------|-----------|--------|--------|
| `CGGGGGGGGGGGGGC` | âœ… æ˜¯ | âŒ å¦ | âŒ è¯¯æ£€æµ‹ | âœ… ä¸æ£€æµ‹ |

### æµ‹è¯•åºåˆ— 3ï¼šé™åˆ¶æ€§ä½ç‚¹

**åºåˆ—**ï¼š`AAAGAATTCAAA` (EcoRI)

| ä½ç‚¹ | åºåˆ— | DNAå›æ–‡ï¼Ÿ | ä¿®å¤å‰ | ä¿®å¤å |
|------|------|-----------|--------|--------|
| EcoRI | `GAATTC` | âœ… æ˜¯ | å¯èƒ½æ¼æ£€ | âœ… æ­£ç¡®æ£€æµ‹ |
| BamHI | `GGATCC` | âœ… æ˜¯ | å¯èƒ½æ¼æ£€ | âœ… æ­£ç¡®æ£€æµ‹ |

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•è„šæœ¬

1. **`docs/test_palindrome_fix.py`**
   - å®Œæ•´æµ‹è¯•ä¿®å¤æ•ˆæœ
   - éªŒè¯ç”¨æˆ·æŠ¥å‘Šçš„é—®é¢˜
   - æµ‹è¯•å¤šç§è¾¹ç•Œæƒ…å†µ

2. **`docs/test_palindrome_true_cases.py`**
   - æµ‹è¯•çœŸæ­£çš„DNAå›æ–‡æ£€æµ‹
   - éªŒè¯é™åˆ¶æ€§ä½ç‚¹è¯†åˆ«
   - ä½¿ç”¨ä¸åŒçš„ `min_len` å‚æ•°

### è¿è¡Œæµ‹è¯•

```bash
# æµ‹è¯•ä¿®å¤æ•ˆæœ
python docs/test_palindrome_fix.py

# æµ‹è¯•çœŸæ­£çš„DNAå›æ–‡
python docs/test_palindrome_true_cases.py
```

### æµ‹è¯•ç»“æœ

```
âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡

å…³é”®éªŒè¯ï¼š
  âœ“ CGGGGGGGGGGGGGC ä¸å†è¢«è¯¯æ£€ä¸ºå›æ–‡
  âœ“ çœŸæ­£çš„DNAå›æ–‡ï¼ˆATCGATç­‰ï¼‰æ­£ç¡®æ£€æµ‹
  âœ“ é™åˆ¶æ€§ä½ç‚¹ï¼ˆGAATTC, GGATCCï¼‰æ­£ç¡®è¯†åˆ«
  âœ“ å‡å›æ–‡ï¼ˆå­—ç¬¦ä¸²å›æ–‡ï¼‰æ­£ç¡®æ’é™¤
  âœ“ Homopolymer ä¸è¢«è¯¯æ£€ä¸ºå›æ–‡
```

---

## ğŸ§¬ ç”Ÿç‰©å­¦æ„ä¹‰

### DNAå›æ–‡çš„é‡è¦æ€§

DNAå›æ–‡åºåˆ—åœ¨åˆ†å­ç”Ÿç‰©å­¦ä¸­å…·æœ‰é‡è¦æ„ä¹‰ï¼š

1. **é™åˆ¶æ€§å†…åˆ‡é…¶è¯†åˆ«ä½ç‚¹**
   - EcoRI: `GAATTC` (5'-GAATTC-3' / 3'-CTTAAG-5')
   - BamHI: `GGATCC`
   - PstI: `CTGCAG`

2. **åŸºå› è°ƒæ§å…ƒä»¶**
   - è½¬å½•å› å­ç»“åˆä½ç‚¹
   - å¢å¼ºå­å’Œå¯åŠ¨å­åºåˆ—

3. **åŸºå› å·¥ç¨‹åº”ç”¨**
   - å…‹éš†è½½ä½“è®¾è®¡
   - CRISPRä½ç‚¹é€‰æ‹©
   - åŸºå› ç¼–è¾‘é¶ç‚¹

### å­—ç¬¦ä¸²å›æ–‡ vs DNAå›æ–‡

| ç‰¹æ€§ | å­—ç¬¦ä¸²å›æ–‡ | DNAå›æ–‡ |
|------|-----------|---------|
| å®šä¹‰ | ä»ä¸­å¿ƒå¯¹ç§° | åºåˆ— == åå‘äº’è¡¥ |
| ä¾‹å­ | `CGGGGGC` | `ATCGAT` |
| ç”Ÿç‰©å­¦æ„ä¹‰ | âŒ æ—  | âœ… é™åˆ¶æ€§ä½ç‚¹ç­‰ |
| æ£€æµ‹æ–¹æ³• | å­—ç¬¦æ¯”è¾ƒ | ç¢±åŸºäº’è¡¥é…å¯¹ |
| é•¿åº¦è¦æ±‚ | å¥‡æ•°/å¶æ•° | å¿…é¡»å¶æ•° |

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | è¡Œå· | ä¿®æ”¹å†…å®¹ |
|------|------|----------|
| `tools/scripts/AnalysisSequence.py` | 232-341 | å®Œå…¨é‡å†™ `find_palindrome_repeats()` |
| `tools/scripts/AnalysisSequence.py` | 307-341 | æ–°å¢ `_filter_overlapping_palindromes()` |

### ç®—æ³•å¤æ‚åº¦

| æ–¹æ³• | æ—§ç®—æ³• | æ–°ç®—æ³• |
|------|--------|--------|
| æ—¶é—´å¤æ‚åº¦ | O(nÂ²) | O(nÂ² Ã— k) |
| ç©ºé—´å¤æ‚åº¦ | O(n) | O(n) |
| å‡†ç¡®æ€§ | âŒ é”™è¯¯ | âœ… æ­£ç¡® |

æ³¨ï¼šk æ˜¯å¹³å‡å›æ–‡é•¿åº¦ï¼Œé€šå¸¸å¾ˆå°ï¼ˆ<50bpï¼‰ï¼Œå®é™…æ€§èƒ½å¯æ¥å—ã€‚

### æ•ˆç‡ä¼˜åŒ–

1. **åªæ£€æŸ¥å¶æ•°é•¿åº¦**ï¼šDNAå›æ–‡å¿…ç„¶æ˜¯å¶æ•°é•¿åº¦ï¼Œè·³è¿‡å¥‡æ•°
2. **é™åˆ¶æœ€å¤§é•¿åº¦**ï¼šæœ€å¤§æ£€æŸ¥200bpï¼Œé¿å…è¿‡é•¿åºåˆ—
3. **é‡å è¿‡æ»¤**ï¼šå‡å°‘å†—ä½™æŠ¥å‘Š
4. **æ­¥é•¿ä¼˜åŒ–**ï¼šä½¿ç”¨ `range(min_len, max_len, 2)` è·³è¿‡å¥‡æ•°

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **æµ‹è¯•è„šæœ¬**ï¼š
   - `docs/test_palindrome_fix.py` - ä¿®å¤éªŒè¯
   - `docs/test_palindrome_true_cases.py` - çœŸå®æ¡ˆä¾‹æµ‹è¯•

2. **API æ–‡æ¡£**ï¼š
   - `docs/API_SEQUENCE_ANALYSIS.md` - API å®Œæ•´æ–‡æ¡£

3. **å…¶ä»–ç‰¹å¾**ï¼š
   - `docs/INVERTED_REPEATS_FIX.md` - Inverted Repeats ä¼˜åŒ–
   - `docs/TANDEM_MISMATCH_GUIDE.md` - Tandem Repeats å‚æ•°æŒ‡å—

---

## âœ… éªŒè¯æ¸…å•

- [x] ç®—æ³•ä»å­—ç¬¦ä¸²å›æ–‡æ”¹ä¸ºDNAå›æ–‡
- [x] ä½¿ç”¨ `reverse_complement()` éªŒè¯
- [x] åªæ£€æŸ¥å¶æ•°é•¿åº¦åºåˆ—
- [x] æ·»åŠ é‡å è¿‡æ»¤åŠŸèƒ½
- [x] æ›´æ–°å‡½æ•°æ–‡æ¡£å­—ç¬¦ä¸²
- [x] åˆ›å»ºå®Œæ•´æµ‹è¯•è„šæœ¬
- [x] éªŒè¯ç”¨æˆ·æŠ¥å‘Šçš„é—®é¢˜å·²ä¿®å¤
- [x] æµ‹è¯•çœŸæ­£çš„DNAå›æ–‡èƒ½æ­£ç¡®æ£€æµ‹
- [x] æµ‹è¯•å‡å›æ–‡ä¸è¢«æ£€æµ‹
- [x] æµ‹è¯•é™åˆ¶æ€§ä½ç‚¹è¯†åˆ«
- [x] åˆ›å»ºè¯¦ç»†æ–‡æ¡£

---

## ğŸ¯ æ€»ç»“

### é—®é¢˜

ç”¨æˆ·åºåˆ—ä¸­çš„ `CGGGGGGGGGGGGGC` è¢«é”™è¯¯åœ°æ£€æµ‹ä¸ºå›æ–‡åºåˆ—ï¼Œä½†è¿™åªæ˜¯å­—ç¬¦ä¸²å›æ–‡ï¼Œä¸æ˜¯DNAå›æ–‡ã€‚

### è§£å†³æ–¹æ¡ˆ

å®Œå…¨é‡å†™ç®—æ³•ï¼Œä½¿ç”¨æ­£ç¡®çš„DNAå›æ–‡å®šä¹‰ï¼š**åºåˆ— == reverse_complement(åºåˆ—)**

### æ•ˆæœ

- âœ… `CGGGGGGGGGGGGGC` ä¸å†è¢«è¯¯æ£€
- âœ… çœŸæ­£çš„DNAå›æ–‡æ­£ç¡®æ£€æµ‹
- âœ… é™åˆ¶æ€§ä½ç‚¹æ­£ç¡®è¯†åˆ«
- âœ… ç”Ÿç‰©å­¦æ„ä¹‰æ˜ç¡®
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

**ä¿®å¤å®Œæˆï¼** ğŸ‰

**æ›´æ–°æ—¥æœŸ**: 2025-11-06
**ç‰ˆæœ¬**: v2.2 (Palindrome Algorithm Fix)
